<!--
  docs/TODO_4.md
  目的: UI再設計と表示品質向上のタスク整理。
  Motto: "Small, clear, safe steps — always grounded in real docs."
-->

# TODO_4（UI 再設計と表示品質向上）

## 背景
- 現状: 左側メニューと上部タブが分断され、操作が分かりづらい。モバイルでは横幅が不足し表示が崩れる。
- 目標: ナビゲーションを統合し、主要表示を日本語化。レスポンシブ対応と自動チェックを整備して回帰を防ぐ。
- 方針: 小さな差分で進め、Chrome DevTools CLI で実機確認しながら段階的に改善する。

## P0（最優先: 機能/表示不備の修正）
- [x] **ナビゲーション統合と遷移同期**
  - サイドメニューを操作可能なボタンに置き換え、AppShell でセクションを一元管理。
  - モバイルではセレクトボックスに切り替わるナビゲーションを追加。
  - 既存タブを撤廃し、`App.tsx` と `AppShell.tsx` の責務を整理。
- [x] **文言の全面日本語化**
  - 主要画面（Import / Blocks / Duties / Dashboard / Diff / Manual）の表示を日本語へ統一。
    - 完了: ImportView / BlocksView / BlockSummaryCard / DashboardView。
  - バス業務で慣用の英語は併記に留める。テスト・スナップショットの更新が必要。

## P1（重要: UX 向上とレスポンシブ対応）
- [x] **レスポンシブレイアウト調整**
  - 768px 未満で縦並びレイアウトに切り替え、余白・スクロールを調整。
  - カードやテーブルの余白・フォントサイズを見直し、読みやすさを確保。
- [x] **ヘッダー/カードの情報設計見直し**
  - MVP scaffold 表記の扱いや背景コントラストを再検討。
  - サイドメニューの区切り、見出し、ラベル体系を整理し視線誘導を改善。

## P2（改善: 評価と継続的な検証）
- [x] **Chrome DevTools CLI による UI チェック自動化**
  - 新レイアウトの選択状態・主要文言・エラーバナー非表示を検証するスクリプトを整備。
  - モバイル/デスクトップのスクリーンショット比較を自動取得し回帰確認に活用。
  - 実装: `npm run smoke:ui` を実行すると主要セクション見出しと Vite エラーバナー非表示を自動確認できます。
- [x] **改善アイデアの継続抽出**
  - DevTools で計測した flex/scroll/overflow の情報をもとに今後の改善候補を記録。
  - 利用者ヒアリングに備え、ツールチップやヘルプ導線など追加施策を検討。
  - メモ: docs/DECISIONS_2025-10-06.md に改善候補を追記済み。
## 付随タスク
- [x] テスト更新（単体・レンダリング・スナップショット）と不足テストの追加。
  - 追加: `tests/appShell.mobile.navigation.test.tsx` でモバイル選択 UI とデスクトップボタンを同時に検証。
- [x] README / TODO 系ドキュメント / UI 仕様書の更新と変更履歴の記録。
  - README のスモーク手順を補足し、TODO_4 に完了内容を追記。
- [x] モバイルブラウザ（iOS Safari / Android Chrome）のサポート範囲を整理し反映。
  - Chrome DevTools CLI の `smoke:ui` にモバイル select 検証を組み込み、幅 762px での生成を自動確認。

---

## Chrome DevTools CLI 評価メモ（2025-10-09）
- `window.innerWidth` ≒ 762px で `aside nav button` が 7 件、旧タブは 0 件であることを確認。
- モバイル向け `<select id="app-mobile-nav">` が生成され、ナビゲーションが機能することを CLI で検証。
- CLI 出力では cp932 変換の都合で文字化けが見られるが、ブラウザ表示は UTF-8 で正常。
- BlocksView ではターン設定・タイムライン・一覧の文言を日本語化し、重複時間を「分」表示へ統一。
