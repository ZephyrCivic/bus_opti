# 保存系導線 — ワイヤーフレーム（モック）

最終更新: 2025-10-22

本モックは「差分・出力」タブへ保存/出力導線を集約する UI イメージをテキストで共有する。実装は後続 Exec Plan で行う。

## 左ナビ: 差分・出力（展開時）

```
┌ 差分・出力 ───────────────────────────────────┐
│ セクション1: 保存                                             │
│  ├─ [ プロジェクトを保存（JSON） ]  (Primary)                  │
│  │     説明: 手動編集を含む現在のプロジェクトを保存します。    │
│  ├─ [ 取込結果を保存（JSON） ]                                  │
│  │     説明: GTFS解析結果のみをバックアップします。             │
│  │     備考: 自動保存は30秒間隔。                              │
│                                                              │
│ セクション2: エクスポート                                      │
│  ├─ Blocks CSV        ── [ダウンロード] (権限○)                 │
│  ├─ Duties CSV        ── [ダウンロード] (権限× → 鍵アイコン)    │
│  ├─ Diff JSON         ── [ダウンロード]                          │
│                                                              │
│ セクション3: 履歴 & 監査                                       │
│  ├─ 2025-10-22 11:40  プロジェクト保存（admin）   [再ダウンロード]│
│  ├─ 2025-10-22 10:05  Blocks CSV エクスポート（ops01）          │
│  ├─ ...（最新5件）                                             │
│  └─ [ 監査ログをダウンロード ]                                 │
└──────────────────────────────────────────────────────┘
```

- 未保存バッジ: タブ見出し「差分・出力」に `●` を表示し、ツールチップ「未保存の変更があります」。
- 権限×の項目は `aria-disabled="true"`、キーアイコン、ツールチップ「管理者のみ利用可」。

## ImportView: 取込サマリー下ヒント

```
┌ ヒント ─────────────────────┐
│ 保存・出力は左の「差分・出力」から行えます。│
└──────────────────────────┘
```

- ヒント末尾に [差分・出力を開く] のショートカット（キーボード: Alt+Shift+S）。

## Explorer/Blocks/Duties: トップバー

```
┌ トップバー ───────────────────────────────────────────────┐
│ Breadcrumb > Explorer                                              │
│                                                                      │
│ 変更ステータス: ● 未保存あり（前回保存 2025-10-22 11:40）           │
│  [ 差分・出力を開く ]（Secondary Button, ショートカット共通）        │
└────────────────────────────────────────────────────────────────┘
```

- 変更ステータスはテキストのみ（押下不可）。ボタン押下で左ナビタブを開く。
- 未保存が解消すると灰色の `✓ 保存済み（前回保存...）` に変化。

## 保存結果トースト

```
[Toast] 保存が完了しました。ファイル: project-20251022-1142.json
```

- 4秒後に自動閉じ。`aria-live="polite"` セット。

## エラー表示（保存失敗時）

```
┌ エラー（role=alert） ──────────────────────────────────┐
│ 保存に失敗しました。ネットワーク接続を確認して再試行してください。│
│ [ 再試行 ]   [ 詳細ログ ]                                           │
└──────────────────────────────────────────────────────────┘
```

- 表示時にフォーカスを内部の `再試行` ボタンへ移動。

## 操作シナリオ要約
1. Import 後、ヒントから左ナビを開き保存 → トーストで完了、履歴に追加。
2. 編集で未保存状態に変化 → トップバーとタブバッジで通知。
3. エクスポート権限がないユーザーは CSV ボタンが無効化され、ツールチップで理由が分かる。
4. 監査ログダウンロードは管理者のみ表示され、実行で監査レコードが追記される。

## 次ステップ参照
- 仕様詳細: docs/specs/save-flows-navigation.md
- 実装計画: Exec Plan（保存導線見直し）で管理予定。
